from typing import Dict, List
import logging

# Configure logging
logging.basicConfig(level=logging.INFO)

if 'transformer' not in globals():
    from mage_ai.data_preparation.decorators import transformer

@transformer
def transform(messages: List[Dict], *args, **kwargs):
    """
    Processes incoming messages from Kafka.

    Args:
        messages (List[Dict]): List of messages from Kafka.

    Returns:
        List[Dict]: Transformed messages ready for export.
    """
    logging.info(f"Transforming {len(messages)} messages.")

    processed_messages = []
    for msg in messages:
        # Example transformation: You can add your own logic here
        data = {
            'client_id': msg.get('client_id'),
            'features': {
                'age': msg.get('age'),
                'income': msg.get('income'),
                'gender': msg.get('gender')
            }
        }
        processed_messages.append(data)

    logging.info(f"Transformed {len(processed_messages)} messages.")
    return processed_messages